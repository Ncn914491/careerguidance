#!/usr/bin/env node

/**
 * Final comprehensive fix script for all issues
 * This script will fix everything in the correct order
 */

const { createClient } = rein();ript
mahe sc/ Run t
}

/ }exit(1);
 ss.proce    r);
ed:', erroipt failscrüí• Final fix .error('oleons  cror) {
  h (er 
  } catc
   s');os + 5 PDF: 30 photg('   Total.loonsole c   ;
 PDF')photos + 1  Week 5: 8 log(' onsole. c);
   tos + 1 PDF' pho4: 7ek ('   Wensole.log  co
  PDF');1 + otos ph 3: 6 '   Weekle.log(  consoDF');
  hotos + 1 P p   Week 2: 5nsole.log(' co
   DF');os + 1 P1: 4 photeek log('   Wnsole.);
    cocounts:'ile üìä Fg('\n  console.lo  
    
t login');thou - Works wichatI t A Teslog('6.  console.0');
  / adminncn@2@yahoo.com itanyanaiduadmin: ncha. Login as ('5sole.log  con
  ding');finite loa inhoutwork witould login - Sh:3000/stlocalhottp:// hsit.log('4. Vi  consoleg');
  te loadininit infk withouworhould - Sgroups 000/:3//localhostttp:t hlog('3. Visie.olons');
    cd loadd PDFs shoull photos anweeks - Alalhost:3000//loctp:/ht2. Visit e.log('onsol   cv');
 den pm ru nment server:developtart 1. Sole.log('  conse:');
  to useady g('\nüöÄ R console.lo
   
    )');uiredno login reqde public (I chat maog('‚úÖ Aonsole.l
    ced');oading fixite ln page infin.log('‚úÖ Logiconsoles)');
    ile2 total faded (5s uplo PDF and All photosole.log('‚úÖ;
    consking')oints wordpend API enntro'‚úÖ Fe.log(  consol');
  rkingccess wolic API a Pub('‚úÖ.logle
    conso);verified'created/user n  Admie.log('‚úÖnsol  cod');
  erifiend data vema ase schog('‚úÖ Databaconsole.l;
    :')ixes fary ofnüìã Summsole.log('\);
    concessfully!'ompleted suces c fix\nüéâ All'og(le.l  conso  
    }
  
  xit(1);cess.e   proiled');
   I test faontend AP'‚ùå Fre.error(  consol   g) {
 orkinIsWendAP if (!front;
   ontendAPIs()t testFrng = awaiendAPIsWorkintconst froest');
    I T APFrontendStep 4: log('\nüìã sole.    con
nd APIsontefrTest // Step 4:     
    ;
    }
s.exit(1)ces      pro;
ed')ilcess test falic acPubrror('‚ùå  console.eg) {
     orkinublicAccessW  if (!p  cess();
stPublicAcait terking = awblicAccessWost pu con
   est');Access Tublic 3: P'\nüìã Step sole.log(ss
    conc acceest publi/ Step 3: T   
    /
    }
 s.exit(1);     proces
 ');up failed user setdmin'‚ùå Ansole.error( co    
 xed) {if (!adminFier();
    ureAdminUs = await enst adminFixed);
    consup'ser Setp 2: Admin Ute\nüìã Sonsole.log(' user
    c adminnsureStep 2: E// 
     
    }
   t(1);ocess.exi
      pr');setup failedse abaerror('‚ùå Dat  console.xed) {
    (!dbFi();
    if seabaeckAndFixDatchd = await st dbFixecon);
    se Setup'Databa: p 1('üìã Stele.loge
    consofix databas and  Check/ Step 1:y {
    /
  
  tr\n');ecte Proj Guidancor Careerve fix fmprehensial coning fine.log('üöÄ Run
  consolon main() {c functi
asyn
}
alse;
  }return f);
    sage, error.mes failed:' testontend APIrror('‚ùå Fr   console.eerror) {
   } catch (turn true;
  
    reps`);
  ou grlength}groups.rking - ${point wooups API end(`‚úÖ Grnsole.log();
    coponse.jsongroupsReswait  groups = a   const
    
 
    } false;rn
      retutus}`);e.staRespons{groups HTTP $PI failed: A‚ùå Groupsror(` console.er
     e.ok) {onspsRespif (!grou
    
    });    
      }
}`baseAnonKeysupaearer ${': `Bization  'Author      y,
pabaseAnonKe suey':   'apik  rs: {
      heade {
   `,lect=*?seupst/v1/groo')}/resupabase.case.co', 'sace('supabl.replaseUrtch(`${supabwait fe = asponseoupsRest grcont
    endpoinPI  groups A // Test  `);
    
 eeks} wth{weeks.leng working - $endpoint‚úÖ Weeks API og(`ole.l  cons);
  onse.json(it weeksResp weeks = awa    const
   ;
    }
 se return fal}`);
     nse.statusRespoTTP ${weeksled: Heks API fairor(`‚ùå Wensole.er
      co{sponse.ok) (!weeksRe 
    if 
     }
    });}`
    KeyonaseAnrer ${supabion': `Beahorizat   'Autey,
     AnonKseabaikey': sup    'aps: {
    er head   {
  )`, es(*fillect=*,week_s?set/v1/weekco')}/res 'supabase.upabase.co',('slacerepeUrl.as${supabwait fetch(`nse = aweeksRespo    const  endpoint
st weeks API{
    // Te  try   
...');
PI endpointsfrontend Ating esüåê Tole.log('() {
  constendAPIsion testFronnctsync fu
a
}
se;
  }urn fal
    retage);.mess errorp failed:',r setu Admin useole.error('‚ùåons
    cerror) {ch (
  } catrue; return t  
   
    }
  );
      }ect role'corrts with ofile exisdmin prle.log('‚úÖ A    consose {
       } elted');
   e upda'‚úÖ Admin rolnsole.log(       co
           }
  se;
     falurn     ret  ge);
   ssa.meeErrorle:', updatroin pdating adm u('‚ùå Errorole.error  cons        
r) {pdateErro   if (u
         
    .id);istingAdmin ex  .eq('id',      min' })
  adle: 'date({ ro         .ups')
 m('profile  .fro       aseAdmin
 upab } = await s updateError { error:  constdmin
       atoole  Update r//  
      'admin') {le !==  profile.rorofile &&} else if (p);
      le created'fin pro‚úÖ Admionsole.log('
        c
        
        }n false;      retursage);
    or.mesertErr:', ins profileadminreating r cor('‚ùå Errosole.err  con      r) {
  nsertErro (i
        if     });
          n'
   le: 'admi ro      ',
     dmin User: 'Amel_na   ful
         minEmail,email: ad         
   id,ngAdmin.sti exi   id:        
 t({inser     .les')
     ('profi.from          seAdmin
bawait supa = aertError }: inserror{    const t
      create it,t exise doesn'   // Profil') {
     'PGRST116= ode ==ileError.cor && profprofileErr    if (
      ();
  ingle
        .s)idtingAdmin.exiseq('id', 
        .ct('*')       .seles')
 'profileom(        .frin
eAdm supabasawait= ileError } or: proferrle, : proficonst { datale
      roh admin ists witle exfinsure pro     // E  
 ;
    sts') already exidmin user.log('‚úÖ A console      } else {
  sfully');
 ed successer creatmin u Adlog('‚úÖ console.
     
       }alse;
       return fe);
      rror.messagrofileEe:', profiling admin preatrror ce.error('‚ùå Eonsol     c{
   fileError)  if (pro       
  });
    in'
      role: 'adm     er',
     Use: 'Admin   full_nam      nEmail,
  : admi  email    id,
    ata.user.  id: authD       .insert({
 )
        ('profiles'from .       abaseAdmin
sup = await or }rofileErrrror: pst { e
      con profile   // Create
      
       }n false;
       retursage);
   or.mescreateErrr:', seg admin u creatinorErrle.error('‚ùå    conso) {
     Error  if (create    
      });
   
   irm: truemail_conf  e0',
      @2cn'adminnsword:   pasail,
      : adminEm      emailser({
  createUth.admin.Admin.auseit supabar } = awa: createErrorrorauthData, edata:    const { 
      
   ...');sering admin ureatg('üîß Cole.lo
      consdmin) {ingA  if (!exist;
    
  inEmail)adm= == => u.email (uers.find.usrsuse = xistingAdmint e
    cons';comhoo.yaanaidu@= 'nchaitanyil nst adminEma    
    co}

    false;urn   ret
    e);r.messagstErrosers:', ling uor listirrror('‚ùå Eeronsole.     c
 stError) {if (li   
    ();
 ersdmin.listUsAdmin.auth.aasewait supabr } = atErro error: lis users,{ data:onst sts
    cximin user eheck if ad// C {
    
  
  try.');exists..min user uring adnse.log('üë§ E
  consolUser() { ensureAdminfunctionync }
}

as  e;
alsurn f
    rete);rror.messagd:', es test faileblic accesr('‚ùå Purroe.eonsol) {
    corerrtch (  } catrue;
 return   
    
 roups`);gth} groups.len- ${gg  workinps accesslic grou‚úÖ Pubg(`e.lo   consol
    
 alse;
    }  return f
    .message);rrorpsEled:', grouaccess faiups blic groerror('‚ùå Pusole.  conr) {
    sErrof (group
    i   *');
 (' .select    
 oups').from('gr     eAnon
 ait supabas = awroupsError }error: gups, ta: gro  const { daclient
   with anon  groups API    // Test 
;
   h} weeks`)engteeks.lorking - ${wks access wublic wee‚úÖ Pg(`loonsole. c  
    
  }false;
   rn 
      retussage);ror.me:', weeksErailed feeks access wr('‚ùå Publicrosole.er
      coneksError) {
    if (we    er');
week_numb   .order('     `)
   s (*)
  week_file
               *,ect(`
 .sel
     weeks')     .from('aseAnon
 supabait Error } = awror: weeksa: weeks, er { dat
    constclientI with anon t weeks AP// Tes
     
  try {
 ess...');ccpublic API ag ('üß™ Testinconsole.log() {
  AccessestPublic ttionync func
}

asse;
  }n fal;
    retur.message)ed:', erroril check fabase‚ùå Datar('.erroonsole    c(error) {
atch 
  } crue;eturn t    
    r }
;
   ully')successfata seeded ups d('‚úÖ Groonsole.log     c 
   }
     ;
    alseurn f ret     );
  essageor.msInsertErr, groupups:'eding gro se'‚ùå Errorsole.error(
        con) {Errornsert(groupsI
      if ps);
      pleGrou.insert(sam       ups')
   .from('gro   
   nupabaseAdmi await s } =rrornsertEoupsI error: gr {const           
   ];
    }
   '
     velopment. skill deinch other d support ea anls materia learningte onrabo: 'Collaptioncri     desup',
     dy Gro'Stume:      na
           { },
    
     unities.'portr op careeaboutghts nsiare ind shdustries arious incuss va'Dison: pti    descri,
      ry Insights'ust'Ind      name:     {
    },
          '
  s.n from other learces andiew experienintervour 'Share ycription:       des   nces',
 ew ExperieIntervi 'ame:         n        {
   },
  
    rest.'d of inteeld to your fis relatecal questionchniwer te and ansAskion: '    descript     ,
 hnical Q&A'Tec name: '  
               {  },
'
      ities.pportunnd odance at career gui aboudiscussions general place for 'A tion:crip   des      cussion',
 General Dis name: '       {
     [
     eGroups = const sampl     ;
      
  data...')groups('üå± Seeding e.lognsol      coh === 0) {
s.lengtgroup  if (    
  tabase`);
n daups i.length} gro${groupsund (`üë• Fonsole.log
    co      }
  e;
n fals  retur;
    .message)oupsErrorps:', grcking grouor cherror('‚ùå Erronsole.e     c {
 upsError)if (gro     
'*');
   ect(   .sel
   groups')    .from('dmin
  upabaseAwait srror } = aroupsEr: gups, erro: grota da   const {ups
 gro// Check 
    
    ;
    }essfully')cceeded su data s‚úÖ Weeksole.log('
      cons
      e;
      }eturn fals        rssage);
r.me, insertErroeks:'eding wese Error '‚ùår(onsole.erro c
       Error) {if (insert        
    
Weeks);sample   .insert(s')
     .from('week    eAdmin
     supabas} = awaitertError : ins error    const {  
       ];
   }
    th.'
      onal grownd professiancement aareer adves for c Strategining.lear continuous networks andssional profe 'Building ion:pt   descri       ment',
elopssional Devrofeg and Petworkin  title: 'N      : 5,
  eek_number       w   {
   
     },        .'
tion skillsunicasional command profeses ew techniqurs. Interviteover letmes and cfective resuefating  'Creription:esc
          dtion',eparaview Prd Interng anBuildi 'Resume     title:
      number: 4,    week_         {
   ,
  
        }ies.' opportunitured futemands an d marketis of job Analysds.market trenurrent standing cer and undt industriesdifferenExploring n: 'iptio       descrs',
   rendd Market Tploration anry Exst: 'Indu  title    3,
    mber: week_nu
             {     ,
  }.'
       explorationareernd cment asessr self-ases fond techniqu. Tools ad skills annterests,strengths, ing personal standi 'Underescription:       dation',
    Identificllst and Skimen'Self-Assesstle:          ti,
 er: 2 week_numb
         
        {        },
nning.' place of careere importanand thpaths career ious to varoduction ciples. Intrinidance pr and gunitiespportuareer oew of cervi: 'Ov description
         uidance',eer Gto Caroduction ntr'I:        title
   : 1,number week_{
          [
        mpleWeeks =nst sa  co 
        ;
 ...')s datang week('üå± Seedile.log
      consoh === 0) {ks.lengtf (wee
    i
    abase`);dat in gth} weeksennd ${weeks.llog(`üìä Fou    console.  }
    

   false;  returnage);
    .messeeksErrors:', wng weekror checki.error('‚ùå Er    consolerror) {
  if (weeksE
    );
    _number'er('week .ord   )
  t('*'.selec  eeks')
    rom('w
      .fdminsupabaseAawait ksError } = error: weeks, a: weenst { dat   colient
  admin ck weeks withChec  // ry {
  
  t..');
  e.abase statng dat('üîç Checkionsole.log() {
  cxDatabaseAndFiction check
async funy);
nonKe supabaseArl,baseUient(supateCl= creanon  supabaseAstconnd)
frontee  client (likeate anon

// Cr }
});false
 ession: persistSse,
    alreshToken: futoRef  a auth: {
  y, {
 erviceKeupabaseSseUrl, sabant(supateClieAdmin = creabaseup
const sientin cleate adm}

// Crs.exit(1);
ces
  probles');ment variaase environing Supabrror('‚ùå Miss console.eKey) {
 eAnon !supabas||y ServiceKepabaseUrl || !suf (!supabase
iON_KEY;
_SUPABASE_ANPUBLICenv.NEXT_rocess.onKey = peAnt supabasE_KEY;
consSERVICE_ROLSUPABASE_cess.env.eKey = proaseServicconst supabBASE_URL;
LIC_SUPAenv.NEXT_PUBrocess.aseUrl = pupabnst s });

colocal': '.env.athonfig({ pdotenv').c
require('esent variablnmad enviro);

// Lobase-js'supa'@supabase/quire(